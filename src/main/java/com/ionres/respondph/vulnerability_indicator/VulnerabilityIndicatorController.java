

package com.ionres.respondph.vulnerability_indicator;

import com.ionres.respondph.household_score.HouseholdScoreCalculate;
import com.ionres.respondph.util.AlertDialogManager;
import com.ionres.respondph.util.AppContext;
import com.ionres.respondph.util.DashboardRefresher;
import javafx.event.ActionEvent;
import javafx.event.EventHandler;
import javafx.fxml.FXML;
import javafx.scene.control.Button;
import javafx.scene.control.TextField;
import javafx.scene.control.TextFormatter;
import javafx.scene.layout.AnchorPane;

import java.time.LocalDate;
import java.util.function.UnaryOperator;

public class VulnerabilityIndicatorController {
    private final VulnerabilityIndicatorService vulnerabilityIndicatorDAOService = AppContext.vulnerabilityIndicatorService;
    int id = 1;

    @FXML
    private AnchorPane rootPane;

    @FXML private TextField maleScoreFld;
    @FXML private TextField femaleScoreFld;

    @FXML private TextField singleScoreFld;
    @FXML private TextField marriedScoreFld;
    @FXML private TextField widowedScoreFld;
    @FXML private TextField separatedScoreFld;

    @FXML private TextField soloParentNotSoloParentScoreFld;
    @FXML private TextField soloParentYesWithSupportScoreFld;
    @FXML private TextField soloParentYesWithoutSupportScoreFld;

    @FXML private TextField disabilityNoneScoreFld;
    @FXML private TextField disabilityPhysicalScoreFld;
    @FXML private TextField disabilityVisualScoreFld;
    @FXML private TextField disabilityHearingScoreFld;
    @FXML private TextField disabilitySpeechScoreFld;
    @FXML private TextField disabilityIntellectualScoreFld;
    @FXML private TextField disabilityMentalScoreFld;
    @FXML private TextField disabilityChronicScoreFld;
    @FXML private TextField disabilityMultipleDisabilitiesFld;

    @FXML private TextField healthHealthyScoreFld;
    @FXML private TextField healthTemporarilyIllScoreFld;
    @FXML private TextField healthChronicallyIllScoreFld;
    @FXML private TextField healthImmunocompromisedScoreFld;
    @FXML private TextField healthTerminallyIllScoreFld;
    @FXML private TextField healthWithHistoryScoreFld;

    @FXML private TextField cleanWaterYesScoreFld;
    @FXML private TextField cleanWaterNoScoreFld;
    @FXML private TextField cleanWaterOccasionallyScoreFld;

    @FXML private TextField sanitationSafelyScoreFld;
    @FXML private TextField sanitationSharedScoreFld;
    @FXML private TextField sanitationUnimprovedScoreFld;
    @FXML private TextField sanitationNoScoreFld;

    @FXML private TextField houseConcreteScoreFld;
    @FXML private TextField houseLightMaterialsScoreFld;
    @FXML private TextField houseSemiConcreteScoreFld;
    @FXML private TextField houseMakeshiftScoreFld;

    @FXML private TextField ownershipOwnedScoreFld;
    @FXML private TextField ownershipOwnedWithoutScoreFld;
    @FXML private TextField ownershipRentedScoreFld;
    @FXML private TextField ownershipInformalScoreFld;
    @FXML private TextField ownershipEvictedScoreFld;

    @FXML private TextField employmentRegularScoreFld;
    @FXML private TextField employmentSelfEmployedStableScoreFld;
    @FXML private TextField employmentSelfEmployedUnstableScoreFld;
    @FXML private TextField employmentIrregularScoreFld;
    @FXML private TextField employmentUnemployedScoreFld;

    @FXML private TextField incomePoorScoreFld;
    @FXML private TextField incomeLowIncomeScoreFld;
    @FXML private TextField incomeMiddleIncomeScoreFld;
    @FXML private TextField incomeMiddleClassScoreFld;
    @FXML private TextField incomeUpperMiddleClassScoreFld;
    @FXML private TextField incomeUpperIncomeScoreFld;
    @FXML private TextField incomeRichScoreFld;

    @FXML private TextField educationNoFormalScoreFld;
    @FXML private TextField educationElementaryScoreFld;
    @FXML private TextField educationHighschoolScoreFld;
    @FXML private TextField educationVocationalScoreFld;
    @FXML private TextField educationCollegeScoreFld;
    @FXML private TextField educationGraduatedScoreFld;

    @FXML private TextField noVisibleDamage;
    @FXML private TextField minorDamage;
    @FXML private TextField moderateDamage;
    @FXML private TextField severeDamage;
    @FXML private TextField destructionOrCollapse;

    @FXML private TextField digitalReliableScoreFld;
    @FXML private TextField digitalIntermittentScoreFld;
    @FXML private TextField digitalDeviceOnlyScoreFld;
    @FXML private TextField digitalNoDigitalScoreFld;

    @FXML
    private Button saveBtn;

    @FXML
    private void initialize() {
        setupAllNumericFields();
        EventHandler<ActionEvent> handler = this::handleActions;
        saveBtn.setOnAction(handler);
        DashboardRefresher.registerLoadVulScore(this);
        loadVulnerabilityData();
    }

    public void handleActions(ActionEvent event){
        Object src = event.getSource();

        if (src == saveBtn){
            saveVulnerability();
        }
    }

    private void setupAllNumericFields() {
        TextField[] allFields = {
                maleScoreFld, femaleScoreFld,
                singleScoreFld, marriedScoreFld, widowedScoreFld, separatedScoreFld,
                soloParentNotSoloParentScoreFld, soloParentYesWithSupportScoreFld, soloParentYesWithoutSupportScoreFld,
                disabilityNoneScoreFld, disabilityPhysicalScoreFld, disabilityVisualScoreFld,
                disabilityHearingScoreFld, disabilitySpeechScoreFld, disabilityIntellectualScoreFld,
                disabilityMentalScoreFld, disabilityChronicScoreFld, disabilityMultipleDisabilitiesFld,
                healthHealthyScoreFld, healthTemporarilyIllScoreFld, healthChronicallyIllScoreFld,
                healthImmunocompromisedScoreFld, healthTerminallyIllScoreFld, healthWithHistoryScoreFld,
                cleanWaterYesScoreFld, cleanWaterNoScoreFld, cleanWaterOccasionallyScoreFld,
                sanitationSafelyScoreFld, sanitationSharedScoreFld, sanitationUnimprovedScoreFld, sanitationNoScoreFld,
                houseConcreteScoreFld, houseLightMaterialsScoreFld, houseSemiConcreteScoreFld, houseMakeshiftScoreFld,
                ownershipOwnedScoreFld, ownershipOwnedWithoutScoreFld, ownershipRentedScoreFld,
                ownershipInformalScoreFld, ownershipEvictedScoreFld,
                employmentRegularScoreFld, employmentSelfEmployedStableScoreFld, employmentSelfEmployedUnstableScoreFld,
                employmentIrregularScoreFld, employmentUnemployedScoreFld,
                incomePoorScoreFld, incomeLowIncomeScoreFld, incomeMiddleIncomeScoreFld,
                incomeMiddleClassScoreFld, incomeUpperMiddleClassScoreFld, incomeUpperIncomeScoreFld, incomeRichScoreFld,
                educationNoFormalScoreFld, educationElementaryScoreFld, educationHighschoolScoreFld,
                educationVocationalScoreFld, educationCollegeScoreFld, educationGraduatedScoreFld,
                noVisibleDamage, minorDamage, moderateDamage, severeDamage, destructionOrCollapse,
                digitalReliableScoreFld, digitalIntermittentScoreFld, digitalDeviceOnlyScoreFld, digitalNoDigitalScoreFld
        };

        for (TextField field : allFields) {
            if (field != null) {
                setNumericFilter(field);
            }
        }
    }

    private void setNumericFilter(TextField textField) {
        UnaryOperator<TextFormatter.Change> filter = change -> {
            String newText = change.getControlNewText();

            if (newText.isEmpty()) {
                return change;
            }

            if (newText.matches("-?\\d*(\\.\\d*)?")) {
                int decimalCount = newText.length() - newText.replace(".", "").length();
                if (decimalCount <= 1) {
                    return change;
                }
            }

            return null;
        };

        textField.setTextFormatter(new TextFormatter<>(filter));
    }

    public void saveVulnerability(){
        if (!validateInput()) {
            return;
        }
        try {
            VulnerabilityIndicatorScoreModel vism = new VulnerabilityIndicatorScoreModel(
                    id,
                    Double.parseDouble(maleScoreFld.getText().trim()),
                    Double.parseDouble(femaleScoreFld.getText().trim()),

                    Double.parseDouble(singleScoreFld.getText().trim()),
                    Double.parseDouble(marriedScoreFld.getText().trim()),
                    Double.parseDouble(widowedScoreFld.getText().trim()),
                    Double.parseDouble(separatedScoreFld.getText().trim()),

                    Double.parseDouble(soloParentNotSoloParentScoreFld.getText().trim()),
                    Double.parseDouble(soloParentYesWithSupportScoreFld.getText().trim()),
                    Double.parseDouble(soloParentYesWithoutSupportScoreFld.getText().trim()),

                    Double.parseDouble(disabilityNoneScoreFld.getText().trim()),
                    Double.parseDouble(disabilityPhysicalScoreFld.getText().trim()),
                    Double.parseDouble(disabilityVisualScoreFld.getText().trim()),
                    Double.parseDouble(disabilityHearingScoreFld.getText().trim()),
                    Double.parseDouble(disabilitySpeechScoreFld.getText().trim()),
                    Double.parseDouble(disabilityIntellectualScoreFld.getText().trim()),
                    Double.parseDouble(disabilityMentalScoreFld.getText().trim()),
                    Double.parseDouble(disabilityChronicScoreFld.getText().trim()),
                    Double.parseDouble(disabilityMultipleDisabilitiesFld.getText().trim()),

                    Double.parseDouble(healthHealthyScoreFld.getText().trim()),
                    Double.parseDouble(healthTemporarilyIllScoreFld.getText().trim()),
                    Double.parseDouble(healthChronicallyIllScoreFld.getText().trim()),
                    Double.parseDouble(healthImmunocompromisedScoreFld.getText().trim()),
                    Double.parseDouble(healthTerminallyIllScoreFld.getText().trim()),
                    Double.parseDouble(healthWithHistoryScoreFld.getText().trim()),

                    Double.parseDouble(cleanWaterYesScoreFld.getText().trim()),
                    Double.parseDouble(cleanWaterNoScoreFld.getText().trim()),
                    Double.parseDouble(cleanWaterOccasionallyScoreFld.getText().trim()),

                    Double.parseDouble(sanitationSafelyScoreFld.getText().trim()),
                    Double.parseDouble(sanitationSharedScoreFld.getText().trim()),
                    Double.parseDouble(sanitationUnimprovedScoreFld.getText().trim()),
                    Double.parseDouble(sanitationNoScoreFld.getText().trim()),

                    Double.parseDouble(houseConcreteScoreFld.getText().trim()),
                    Double.parseDouble(houseLightMaterialsScoreFld.getText().trim()),
                    Double.parseDouble(houseSemiConcreteScoreFld.getText().trim()),
                    Double.parseDouble(houseMakeshiftScoreFld.getText().trim()),

                    Double.parseDouble(ownershipOwnedScoreFld.getText().trim()),
                    Double.parseDouble(ownershipOwnedWithoutScoreFld.getText().trim()),
                    Double.parseDouble(ownershipRentedScoreFld.getText().trim()),
                    Double.parseDouble(ownershipInformalScoreFld.getText().trim()),
                    Double.parseDouble(ownershipEvictedScoreFld.getText().trim()),

                    Double.parseDouble(employmentRegularScoreFld.getText().trim()),
                    Double.parseDouble(employmentSelfEmployedStableScoreFld.getText().trim()),
                    Double.parseDouble(employmentSelfEmployedUnstableScoreFld.getText().trim()),
                    Double.parseDouble(employmentIrregularScoreFld.getText().trim()),
                    Double.parseDouble(employmentUnemployedScoreFld.getText().trim()),

                    Double.parseDouble(incomePoorScoreFld.getText().trim()),
                    Double.parseDouble(incomeLowIncomeScoreFld.getText().trim()),
                    Double.parseDouble(incomeMiddleIncomeScoreFld.getText().trim()),
                    Double.parseDouble(incomeMiddleClassScoreFld.getText().trim()),
                    Double.parseDouble(incomeUpperMiddleClassScoreFld.getText().trim()),
                    Double.parseDouble(incomeUpperIncomeScoreFld.getText().trim()),
                    Double.parseDouble(incomeRichScoreFld.getText().trim()),

                    Double.parseDouble(educationNoFormalScoreFld.getText().trim()),
                    Double.parseDouble(educationElementaryScoreFld.getText().trim()),
                    Double.parseDouble(educationHighschoolScoreFld.getText().trim()),
                    Double.parseDouble(educationVocationalScoreFld.getText().trim()),
                    Double.parseDouble(educationCollegeScoreFld.getText().trim()),
                    Double.parseDouble(educationGraduatedScoreFld.getText().trim()),

                    Double.parseDouble(digitalReliableScoreFld.getText().trim()),
                    Double.parseDouble(digitalIntermittentScoreFld.getText().trim()),
                    Double.parseDouble(digitalDeviceOnlyScoreFld.getText().trim()),
                    Double.parseDouble(digitalNoDigitalScoreFld.getText().trim()),

                    Double.parseDouble(noVisibleDamage.getText().trim()),
                    Double.parseDouble(minorDamage.getText().trim()),
                    Double.parseDouble(moderateDamage.getText().trim()),
                    Double.parseDouble(severeDamage.getText().trim()),
                    Double.parseDouble(destructionOrCollapse.getText().trim()),

                    LocalDate.now().toString()
            );

            boolean success = vulnerabilityIndicatorDAOService.createVulnerabilityIndicatorScore(vism);

            if (success) {
                // CASCADE UPDATE: Recalculate household scores (which will cascade to aid scores)
                HouseholdScoreCalculate householdCalculator = new HouseholdScoreCalculate();
                int householdRecalculated = householdCalculator.recalculateAllHouseholdScoresWithAidCascade();

                String message = "Vulnerability indicator scores saved successfully.\n" +
                        householdRecalculated + " household score(s) and their aid scores recalculated.";

                AlertDialogManager.showSuccess("Success", message);
            } else {
                AlertDialogManager.showError("Error", "Failed to save vulnerability indicator scores.");
            }

        } catch (NumberFormatException e) {
            AlertDialogManager.showError("Invalid Input", "Please enter valid numeric values for all score fields.");
        } catch (Exception e) {
            AlertDialogManager.showError("Error", "An error occurred while saving: " + e.getMessage());
            e.printStackTrace();
        }
    }

    private boolean validateInput() {
        if (maleScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Male score is required.");
            maleScoreFld.requestFocus();
            return false;
        }

        if (femaleScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Female score is required.");
            femaleScoreFld.requestFocus();
            return false;
        }

        if (singleScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Single score is required.");
            singleScoreFld.requestFocus();
            return false;
        }

        if (marriedScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Married score is required.");
            marriedScoreFld.requestFocus();
            return false;
        }

        if (widowedScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Widowed score is required.");
            widowedScoreFld.requestFocus();
            return false;
        }

        if (separatedScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Separated score is required.");
            separatedScoreFld.requestFocus();
            return false;
        }

        if (soloParentNotSoloParentScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Solo parent (Not Solo Parent) score is required.");
            soloParentNotSoloParentScoreFld.requestFocus();
            return false;
        }

        if (soloParentYesWithSupportScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Solo parent (Yes With Support) score is required.");
            soloParentYesWithSupportScoreFld.requestFocus();
            return false;
        }

        if (soloParentYesWithoutSupportScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Solo parent (Yes Without Support) score is required.");
            soloParentYesWithoutSupportScoreFld.requestFocus();
            return false;
        }

        if (disabilityNoneScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Disability none score is required.");
            disabilityNoneScoreFld.requestFocus();
            return false;
        }

        if (disabilityPhysicalScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Disability physical score is required.");
            disabilityPhysicalScoreFld.requestFocus();
            return false;
        }

        if (disabilityVisualScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Disability visual score is required.");
            disabilityVisualScoreFld.requestFocus();
            return false;
        }

        if (disabilityHearingScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Disability hearing score is required.");
            disabilityHearingScoreFld.requestFocus();
            return false;
        }

        if (disabilitySpeechScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Disability speech score is required.");
            disabilitySpeechScoreFld.requestFocus();
            return false;
        }

        if (disabilityIntellectualScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Disability intellectual score is required.");
            disabilityIntellectualScoreFld.requestFocus();
            return false;
        }

        if (disabilityMentalScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Disability mental score is required.");
            disabilityMentalScoreFld.requestFocus();
            return false;
        }

        if (disabilityChronicScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Disability chronic score is required.");
            disabilityChronicScoreFld.requestFocus();
            return false;
        }

        if (disabilityMultipleDisabilitiesFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Disability multiple disabilities score is required.");
            disabilityMultipleDisabilitiesFld.requestFocus();
            return false;
        }

        if (healthHealthyScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Health healthy score is required.");
            healthHealthyScoreFld.requestFocus();
            return false;
        }

        if (healthTemporarilyIllScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Health temporarily ill score is required.");
            healthTemporarilyIllScoreFld.requestFocus();
            return false;
        }

        if (healthChronicallyIllScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Health chronically ill score is required.");
            healthChronicallyIllScoreFld.requestFocus();
            return false;
        }

        if (healthImmunocompromisedScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Health immunocompromised score is required.");
            healthImmunocompromisedScoreFld.requestFocus();
            return false;
        }

        if (healthTerminallyIllScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Health terminally ill score is required.");
            healthTerminallyIllScoreFld.requestFocus();
            return false;
        }

        if (healthWithHistoryScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Health with medical score is required.");
            healthWithHistoryScoreFld.requestFocus();
            return false;
        }

        if (cleanWaterYesScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Clean water yes score is required.");
            cleanWaterYesScoreFld.requestFocus();
            return false;
        }

        if (cleanWaterNoScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Clean water no score is required.");
            cleanWaterNoScoreFld.requestFocus();
            return false;
        }

        if (cleanWaterOccasionallyScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Clean water irregular score is required.");
            cleanWaterOccasionallyScoreFld.requestFocus();
            return false;
        }

        if (sanitationSafelyScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Sanitation safely score is required.");
            sanitationSafelyScoreFld.requestFocus();
            return false;
        }

        if (sanitationSharedScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Sanitation shared score is required.");
            sanitationSharedScoreFld.requestFocus();
            return false;
        }

        if (sanitationUnimprovedScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Sanitation unimproved score is required.");
            sanitationUnimprovedScoreFld.requestFocus();
            return false;
        }

        if (sanitationNoScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Sanitation no score is required.");
            sanitationNoScoreFld.requestFocus();
            return false;
        }

        if (houseConcreteScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "House concrete score is required.");
            houseConcreteScoreFld.requestFocus();
            return false;
        }

        if (houseLightMaterialsScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "House light materials score is required.");
            houseLightMaterialsScoreFld.requestFocus();
            return false;
        }

        if (houseSemiConcreteScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "House semi concrete score is required.");
            houseSemiConcreteScoreFld.requestFocus();
            return false;
        }

        if (houseMakeshiftScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "House makeshift score is required.");
            houseMakeshiftScoreFld.requestFocus();
            return false;
        }

        if (ownershipOwnedScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Ownership owned score is required.");
            ownershipOwnedScoreFld.requestFocus();
            return false;
        }

        if (ownershipOwnedWithoutScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Ownership owned without score is required.");
            ownershipOwnedWithoutScoreFld.requestFocus();
            return false;
        }

        if (ownershipRentedScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Ownership rented score is required.");
            ownershipRentedScoreFld.requestFocus();
            return false;
        }

        if (ownershipInformalScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Ownership informal score is required.");
            ownershipInformalScoreFld.requestFocus();
            return false;
        }

        if (ownershipEvictedScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Ownership evicted score is required.");
            ownershipEvictedScoreFld.requestFocus();
            return false;
        }

        if (employmentRegularScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Employment regular score is required.");
            employmentRegularScoreFld.requestFocus();
            return false;
        }

        if (employmentSelfEmployedStableScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Employment self-employed stable score is required.");
            employmentSelfEmployedStableScoreFld.requestFocus();
            return false;
        }

        if (employmentSelfEmployedUnstableScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Employment self-employed unstable score is required.");
            employmentSelfEmployedUnstableScoreFld.requestFocus();
            return false;
        }

        if (employmentIrregularScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Employment irregular score is required.");
            employmentIrregularScoreFld.requestFocus();
            return false;
        }

        if (employmentUnemployedScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Employment unemployed score is required.");
            employmentUnemployedScoreFld.requestFocus();
            return false;
        }

        if (incomePoorScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Income poor score is required.");
            incomePoorScoreFld.requestFocus();
            return false;
        }

        if (incomeLowIncomeScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Income low income score is required.");
            incomeLowIncomeScoreFld.requestFocus();
            return false;
        }

        if (incomeMiddleIncomeScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Income middle income score is required.");
            incomeMiddleIncomeScoreFld.requestFocus();
            return false;
        }

        if (incomeMiddleClassScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Income middle class score is required.");
            incomeMiddleClassScoreFld.requestFocus();
            return false;
        }

        if (incomeUpperMiddleClassScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Income upper middle class score is required.");
            incomeUpperMiddleClassScoreFld.requestFocus();
            return false;
        }

        if (incomeUpperIncomeScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Income upper income score is required.");
            incomeUpperIncomeScoreFld.requestFocus();
            return false;
        }

        if (incomeRichScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Income rich score is required.");
            incomeRichScoreFld.requestFocus();
            return false;
        }

        if (educationNoFormalScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Education no formal score is required.");
            educationNoFormalScoreFld.requestFocus();
            return false;
        }

        if (educationElementaryScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Education elementary score is required.");
            educationElementaryScoreFld.requestFocus();
            return false;
        }

        if (educationHighschoolScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Education highschool score is required.");
            educationHighschoolScoreFld.requestFocus();
            return false;
        }

        if (educationVocationalScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Education vocational score is required.");
            educationVocationalScoreFld.requestFocus();
            return false;
        }

        if (educationCollegeScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Education college score is required.");
            educationCollegeScoreFld.requestFocus();
            return false;
        }

        if (educationGraduatedScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Education graduated score is required.");
            educationGraduatedScoreFld.requestFocus();
            return false;
        }

        if(noVisibleDamage.getText().trim().isEmpty()){
            AlertDialogManager.showWarning("Validation Error", "No Visible Damage score is required.");
            noVisibleDamage.requestFocus();
            return false;
        }

        if(minorDamage.getText().trim().isEmpty()){
            AlertDialogManager.showWarning("Validation Error", "Minor Damage score is required.");
            minorDamage.requestFocus();
            return false;
        }

        if(moderateDamage.getText().trim().isEmpty()){
            AlertDialogManager.showWarning("Validation Error", "Moderate Damage score is required.");
            moderateDamage.requestFocus();
            return false;
        }

        if(severeDamage.getText().trim().isEmpty()){
            AlertDialogManager.showWarning("Validation Error", "Severe Damage score is required.");
            severeDamage.requestFocus();
            return false;
        }

        if (destructionOrCollapse.getText().trim().isEmpty()){
            AlertDialogManager.showWarning("Validation Error", "Destruction Or Collapse score is required");
            destructionOrCollapse.requestFocus();
            return false;
        }

        if (digitalReliableScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Digital reliable score is required.");
            digitalReliableScoreFld.requestFocus();
            return false;
        }

        if (digitalIntermittentScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Digital intermittent score is required.");
            digitalIntermittentScoreFld.requestFocus();
            return false;
        }

        if (digitalDeviceOnlyScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Digital limited access score is required.");
            digitalDeviceOnlyScoreFld.requestFocus();
            return false;
        }

        if (digitalNoDigitalScoreFld.getText().trim().isEmpty()) {
            AlertDialogManager.showWarning("Validation Error", "Digital no digital score is required.");
            digitalNoDigitalScoreFld.requestFocus();
            return false;
        }

        return true;
    }

    public void loadVulnerabilityData() {
        int householdId = id;
        try {
            VulnerabilityIndicatorScoreModel vism = vulnerabilityIndicatorDAOService.getData(householdId);

            if (vism == null) {
                AlertDialogManager.showWarning("No Data", "No vulnerability scores found for household ID: " + householdId);
                return;
            }

            maleScoreFld.setText(String.valueOf(vism.getMaleScore()));
            femaleScoreFld.setText(String.valueOf(vism.getFemaleScore()));

            singleScoreFld.setText(String.valueOf(vism.getSingleScore()));
            marriedScoreFld.setText(String.valueOf(vism.getMarriedScore()));
            widowedScoreFld.setText(String.valueOf(vism.getWidowedScore()));
            separatedScoreFld.setText(String.valueOf(vism.getSeparatedScore()));

            soloParentNotSoloParentScoreFld.setText(String.valueOf(vism.getSoloParentNotSoloParentScore()));
            soloParentYesWithSupportScoreFld.setText(String.valueOf(vism.getSoloParentSpWithSnScore()));
            soloParentYesWithoutSupportScoreFld.setText(String.valueOf(vism.getSoloParentSpWithoutSnScore()));

            disabilityNoneScoreFld.setText(String.valueOf(vism.getDisabilityNoneScore()));
            disabilityPhysicalScoreFld.setText(String.valueOf(vism.getDisabilityPhysicalScore()));
            disabilityVisualScoreFld.setText(String.valueOf(vism.getDisabilityVisualScore()));
            disabilityHearingScoreFld.setText(String.valueOf(vism.getDisabilityHearingScore()));
            disabilitySpeechScoreFld.setText(String.valueOf(vism.getDisabilitySpeechScore()));
            disabilityIntellectualScoreFld.setText(String.valueOf(vism.getDisabilityIntellectualScore()));
            disabilityMentalScoreFld.setText(String.valueOf(vism.getDisabilityMentalScore()));
            disabilityChronicScoreFld.setText(String.valueOf(vism.getDisabilityChronicScore()));
            disabilityMultipleDisabilitiesFld.setText(String.valueOf(vism.getDisabilityMultipleScore()));

            healthHealthyScoreFld.setText(String.valueOf(vism.getHealthHealthyScore()));
            healthTemporarilyIllScoreFld.setText(String.valueOf(vism.getHealthTemporarilyIllScore()));
            healthChronicallyIllScoreFld.setText(String.valueOf(vism.getHealthChronicallyIllScore()));
            healthImmunocompromisedScoreFld.setText(String.valueOf(vism.getHealthImmunocompromisedScore()));
            healthTerminallyIllScoreFld.setText(String.valueOf(vism.getHealthTerminallyIllScore()));
            healthWithHistoryScoreFld.setText(String.valueOf(vism.getHealthWithMedicalScore()));

            cleanWaterYesScoreFld.setText(String.valueOf(vism.getCleanWaterYesScore()));
            cleanWaterNoScoreFld.setText(String.valueOf(vism.getCleanWaterNoScore()));
            cleanWaterOccasionallyScoreFld.setText(String.valueOf(vism.getCleanWaterIrregularScore()));

            sanitationSafelyScoreFld.setText(String.valueOf(vism.getSanitationSafelyScore()));
            sanitationSharedScoreFld.setText(String.valueOf(vism.getSanitationSharedScore()));
            sanitationUnimprovedScoreFld.setText(String.valueOf(vism.getSanitationUnimprovedScore()));
            sanitationNoScoreFld.setText(String.valueOf(vism.getSanitationNoScore()));

            houseConcreteScoreFld.setText(String.valueOf(vism.getHouseConcreteScore()));
            houseLightMaterialsScoreFld.setText(String.valueOf(vism.getHouseLightMaterialsScore()));
            houseSemiConcreteScoreFld.setText(String.valueOf(vism.getHouseSemiConcreteScore()));
            houseMakeshiftScoreFld.setText(String.valueOf(vism.getHouseMakeshiftScore()));

            ownershipOwnedScoreFld.setText(String.valueOf(vism.getOwnershipOwnedScore()));
            ownershipOwnedWithoutScoreFld.setText(String.valueOf(vism.getOwnershipOwnedWithoutScore()));
            ownershipRentedScoreFld.setText(String.valueOf(vism.getOwnershipRentedScore()));
            ownershipInformalScoreFld.setText(String.valueOf(vism.getOwnershipInformalScore()));
            ownershipEvictedScoreFld.setText(String.valueOf(vism.getOwnershipEvictedScore()));

            employmentRegularScoreFld.setText(String.valueOf(vism.getEmploymentRegularScore()));
            employmentSelfEmployedStableScoreFld.setText(String.valueOf(vism.getEmploymentSelfEmployedStableScore()));
            employmentSelfEmployedUnstableScoreFld.setText(String.valueOf(vism.getEmploymentSelfEmployedUnstableScore()));
            employmentIrregularScoreFld.setText(String.valueOf(vism.getEmploymentIrregularScore()));
            employmentUnemployedScoreFld.setText(String.valueOf(vism.getEmploymentUnemployedScore()));

            incomePoorScoreFld.setText(String.valueOf(vism.getIncomePoorScore()));
            incomeLowIncomeScoreFld.setText(String.valueOf(vism.getIncomeLowIncomeScore()));
            incomeMiddleIncomeScoreFld.setText(String.valueOf(vism.getIncomeMiddleIncomeScore()));
            incomeMiddleClassScoreFld.setText(String.valueOf(vism.getIncomeMiddleClassScore()));
            incomeUpperMiddleClassScoreFld.setText(String.valueOf(vism.getIncomeUpperMiddleClassScore()));
            incomeUpperIncomeScoreFld.setText(String.valueOf(vism.getIncomeUpperIncomeScore()));
            incomeRichScoreFld.setText(String.valueOf(vism.getIncomeRichScore()));

            educationNoFormalScoreFld.setText(String.valueOf(vism.getEducationNoFormalScore()));
            educationElementaryScoreFld.setText(String.valueOf(vism.getEducationElementaryScore()));
            educationHighschoolScoreFld.setText(String.valueOf(vism.getEducationHighschoolScore()));
            educationVocationalScoreFld.setText(String.valueOf(vism.getEducationVocationalScore()));
            educationCollegeScoreFld.setText(String.valueOf(vism.getEducationCollegeScore()));
            educationGraduatedScoreFld.setText(String.valueOf(vism.getEducationGraduatedScore()));

            digitalReliableScoreFld.setText(String.valueOf(vism.getDigitalReliableScore()));
            digitalIntermittentScoreFld.setText(String.valueOf(vism.getDigitalIntermittentScore()));
            digitalDeviceOnlyScoreFld.setText(String.valueOf(vism.getDigitalLimitedAccessScore()));
            digitalNoDigitalScoreFld.setText(String.valueOf(vism.getDigitalNoDigitalScore()));

            noVisibleDamage.setText(String.valueOf(vism.getNoVisibleDamageScore()));
            minorDamage.setText(String.valueOf(vism.getMinorDamageScore()));
            moderateDamage.setText(String.valueOf(vism.getModerateDamageScore()));
            severeDamage.setText(String.valueOf(vism.getSevereDamageScore()));
            destructionOrCollapse.setText(String.valueOf(vism.getDestructionOrCollapseScore()));

        } catch (Exception e) {
            AlertDialogManager.showError("Error", "Failed to load vulnerability data: " + e.getMessage());
            e.printStackTrace();
        }
    }
}