package com.ionres.respondph.vulnerability_indicator_score;


import com.ionres.respondph.database.DBConnection;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class VulnerabilityIndicatorDAOServiceImpl implements VulnerabilityIndicatorDAOService{
    private final DBConnection connection;
    private  Connection conn;

    public VulnerabilityIndicatorDAOServiceImpl(DBConnection connection){
        this.connection = connection;

    }
    @Override
    public VulnerabilityIndicatorScoreModel getLatestVulnerabilityScores() {
        String sql = "SELECT * FROM vulnerability_indicator_score ORDER BY vulnerability_indicator_id DESC LIMIT 1";

        try {
            conn = connection.getConnection();
            PreparedStatement ps = conn.prepareStatement(sql);
            ResultSet rs = ps.executeQuery();

            if (rs.next()) {
                VulnerabilityIndicatorScoreModel vis = new VulnerabilityIndicatorScoreModel();

                vis.setVulnerabilityIndicatorId(rs.getInt("vulnerability_indicator_id"));

                vis.setMaleScore(rs.getDouble("male_score"));
                vis.setFemaleScore(rs.getDouble("female_score"));
                vis.setOtherScore(rs.getDouble("other_score"));

                vis.setSingleScore(rs.getDouble("single_score"));
                vis.setMarriedScore(rs.getDouble("married_score"));
                vis.setWidowedScore(rs.getDouble("widowed_score"));
                vis.setSeparatedScore(rs.getDouble("separated_score"));
                vis.setDivorceScore(rs.getDouble("divorce_score"));

                vis.setSoloParentYesScore(rs.getDouble("solo_parent_status_yes_score"));
                vis.setSoloParentNoScore(rs.getDouble("solo_parent_status_no_score"));

                vis.setDisabilityNoneScore(rs.getDouble("disability_none_score"));
                vis.setDisabilityPhysicalScore(rs.getDouble("disability_physical_score"));
                vis.setDisabilityVisualScore(rs.getDouble("disability_visual_score"));
                vis.setDisabilityHearingScore(rs.getDouble("disability_hearing_score"));
                vis.setDisabilitySpeechScore(rs.getDouble("disability_speech_score"));
                vis.setDisabilityIntellectualScore(rs.getDouble("disability_intellectual_score"));
                vis.setDisabilityMentalScore(rs.getDouble("disability_mental_or_psychosocial_score"));
                vis.setDisabilityChronicScore(rs.getDouble("disability_chronic_score"));

                vis.setHealthHealthyScore(rs.getDouble("health_healthy_score"));
                vis.setHealthTemporarilyIllScore(rs.getDouble("health_temporarily_ill_score"));
                vis.setHealthChronicallyIllScore(rs.getDouble("health_chronically_ill_score"));
                vis.setHealthImmunocompromisedScore(rs.getDouble("health_immunocompromisedl_score"));
                vis.setHealthTerminallyIllScore(rs.getDouble("health_terminally_ill_score"));
                vis.setHealthWithHistoryScore(rs.getDouble("health_with_history_score"));

                vis.setCleanWaterYesScore(rs.getDouble("clean_water_access_yes_score"));
                vis.setCleanWaterNoScore(rs.getDouble("clean_water_access_no_score"));
                vis.setCleanWaterOccasionallyScore(rs.getDouble("clean_water_access_occasionally_score"));

                vis.setSanitationSafelyScore(rs.getDouble("sanitation_safely_score"));
                vis.setSanitationSharedScore(rs.getDouble("sanitation_shared_score"));
                vis.setSanitationUnimprovedScore(rs.getDouble("sanitation_unimproved_score"));
                vis.setSanitationNoScore(rs.getDouble("sanitation_no_score"));

                vis.setHouseConcreteScore(rs.getDouble("house_construction_concrete_score"));
                vis.setHouseLightMaterialsScore(rs.getDouble("house_construction_light_materials_score"));
                vis.setHouseSemiConcreteScore(rs.getDouble("house_construction_semi_concrete_score"));
                vis.setHouseMakeshiftScore(rs.getDouble("house_construction_makeshirt_score"));

                vis.setOwnershipOwnedScore(rs.getDouble("ownership_owned_score"));
                vis.setOwnershipOwnedWithoutScore(rs.getDouble("ownership_owned_without_score"));
                vis.setOwnershipRentedScore(rs.getDouble("ownership_rented_score"));
                vis.setOwnershipInformalScore(rs.getDouble("ownership_informal_score"));
                vis.setOwnershipEvictedScore(rs.getDouble("ownership_evicted_score"));

                vis.setEmploymentRegularScore(rs.getDouble("employment_regular_score"));
                vis.setEmploymentSelfEmployedStableScore(rs.getDouble("employment_self_employed_stable_score"));
                vis.setEmploymentSelfEmployedUnstableScore(rs.getDouble("employment_self_employed_unstable_score"));
                vis.setEmploymentIrregularScore(rs.getDouble("employment_irregular_score"));
                vis.setEmploymentUnemployedScore(rs.getDouble("employment_unemployed_score"));

                vis.setIncomePoorScore(rs.getDouble("income_poor_score"));
                vis.setIncomeLowIncomeScore(rs.getDouble("income_low_income_score"));
                vis.setIncomeMiddleIncomeScore(rs.getDouble("income_middle_income_score"));
                vis.setIncomeMiddleClassScore(rs.getDouble("income_middle_class_score"));
                vis.setIncomeUpperMiddleClassScore(rs.getDouble("income_upper_middle_class_score"));
                vis.setIncomeRichScore(rs.getDouble("income_rich_score"));

                vis.setEducationNoFormalScore(rs.getDouble("education_no_formal_education_score"));
                vis.setEducationElementaryScore(rs.getDouble("education_elementary_score"));
                vis.setEducationHighschoolScore(rs.getDouble("education_highschool_score"));
                vis.setEducationVocationalScore(rs.getDouble("education_vocational_score"));
                vis.setEducationCollegeScore(rs.getDouble("education_college_score"));
                vis.setEducationGraduatedScore(rs.getDouble("education_graduated_score"));

                vis.setDigitalReliableScore(rs.getDouble("digital_reliable_score"));
                vis.setDigitalIntermittentScore(rs.getDouble("digital_intermittent_score"));
                vis.setDigitalDeviceOnlyScore(rs.getDouble("digital_device_only_score"));
                vis.setDigitalNoDigitalScore(rs.getDouble("digital_no_digital_score"));

                vis.setRegDate(rs.getString("reg_date"));

                return vis;
            }
        } catch (Exception e) {
            e.printStackTrace();
        }

        return null;
    }

    @Override
    public boolean updateVulnerabilityScores(VulnerabilityIndicatorScoreModel scores) {
        return false;
    }

    @Override
    public boolean saveVulnerabilityScores(VulnerabilityIndicatorScoreModel scores) {
        return false;
    }
}
