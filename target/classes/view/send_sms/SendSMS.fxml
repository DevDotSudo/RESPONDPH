<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.*?>
<?import javafx.collections.*?>
<?import javafx.geometry.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<AnchorPane styleClass="send-sms-root"
            stylesheets="@/styles/send_sms/sendsms.css"
            xmlns="http://javafx.com/javafx/17.0.12"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.ionres.respondph.sendsms.SendSMSController">

    <fx:define>
        <ToggleGroup fx:id="smsMode"/>
        <ToggleGroup fx:id="newsAiResponse"/>
    </fx:define>

    <VBox AnchorPane.bottomAnchor="0.0"
          AnchorPane.leftAnchor="0.0"
          AnchorPane.rightAnchor="0.0"
          AnchorPane.topAnchor="0.0">

        <HBox alignment="CENTER_LEFT" spacing="20" styleClass="header-section">
            <padding>
                <Insets bottom="20" left="30" right="30" top="20"/>
            </padding>

            <VBox spacing="8">
                <Label styleClass="page-title" text="Send SMS"/>
                <Label styleClass="page-subtitle"
                       text="Send emergency alerts and notifications to beneficiaries"/>
            </VBox>

            <Region HBox.hgrow="ALWAYS"/>

            <HBox spacing="10" alignment="CENTER_RIGHT">
                <Label fx:id="lblNetworkStatus"
                       text="Internet Status: Checking..."
                       styleClass="network-status-label"/>
                <Button fx:id="btnRefreshNetwork"
                        text="Refresh"
                        styleClass="secondary-button"
                        onAction="#onRefreshNetwork"/>
            </HBox>
        </HBox>

        <ScrollPane fitToWidth="true"
                    styleClass="content-scroll"
                    VBox.vgrow="ALWAYS">

            <VBox spacing="20" styleClass="content-container">
                <padding>
                    <Insets top="20"/>
                </padding>

                <!-- News Selection Section -->
                <VBox spacing="15" styleClass="news-section">
                    <Label styleClass="section-title" text="News Selection"/>

                    <VBox spacing="15" styleClass="news-input-container">
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <Label styleClass="input-label" text="Topic:"/>
                            <ComboBox fx:id="cbNewsTopic"
                                      prefWidth="300"
                                      promptText="Select a topic..."
                                      styleClass="recipient-combo">
                                <items>
                                    <FXCollections fx:factory="observableArrayList">
                                        <String fx:value="National News" />
                                        <String fx:value="Local News" />
                                        <String fx:value="Weather News" />
                                        <String fx:value="Politics News" />
                                        <String fx:value="Health News" />
                                        <String fx:value="Crime / Law / Public Safety News" />
                                    </FXCollections>
                                </items>
                            </ComboBox>
                            <Button fx:id="btnGenerateNews"
                                    styleClass="generate-button"
                                    text="Generate News"
                                    prefWidth="120"
                                    onAction="#onGenerateNews">
                                <padding>
                                    <Insets left="20" right="20"/>
                                </padding>
                            </Button>
                        </HBox>

                        <!-- AI Response Container (initially hidden) -->
                        <VBox fx:id="aiResponseContainer"
                              spacing="12"
                              visible="false"
                              managed="false">
                            <Label fx:id="aiResponseLabel"
                                   styleClass="ai-response-label"
                                   text="AI Generated News Options:"/>

                            <!-- Radio buttons will be dynamically added below the label -->

                            <HBox fx:id="aiResponseActions" alignment="CENTER_LEFT" spacing="10">
                                <Region HBox.hgrow="ALWAYS"/>
                                <Button fx:id="btnUseSelectedNews"
                                        styleClass="secondary-button"
                                        text="Use Selected News"
                                        visible="false"
                                        managed="false"
                                        onAction="#onUseSelectedNews">
                                    <padding>
                                        <Insets left="20" right="20"/>
                                    </padding>
                                </Button>
                            </HBox>
                        </VBox>
                    </VBox>
                </VBox>

                <VBox spacing="15" styleClass="message-section">
                    <Label styleClass="section-title" text="Message Content"/>

                    <VBox spacing="15" styleClass="message-input-container">

                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <Label styleClass="input-label" text="SMS Port:"/>
                            <ComboBox fx:id="cbSelectPorts"
                                      prefWidth="300"
                                      promptText="Select a port..."
                                      styleClass="recipient-combo"/>
                        </HBox>

                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <Label styleClass="input-label" text="Recipient Group:"/>
                            <ComboBox fx:id="cbSelectBeneficiary"
                                      prefWidth="300"
                                      styleClass="recipient-combo">
                                <items>
                                    <FXCollections fx:factory="observableArrayList">
                                        <String fx:value="All Beneficiaries"/>
                                        <String fx:value="By Barangay"/>
                                        <String fx:value="Selected Beneficiaries"/>
                                        <String fx:value="By Disaster Area"/>
                                        <String fx:value="Custom List"/>
                                    </FXCollections>
                                </items>
                            </ComboBox>
                        </HBox>

                        <VBox spacing="8">
                            <Label styleClass="input-label" text="Message:"/>
                            <TextArea fx:id="txtMessage"
                                      prefRowCount="6"
                                      wrapText="true"
                                      promptText="Type your message here..."
                                      styleClass="message-textarea"/>
                        </VBox>

                        <HBox alignment="CENTER_LEFT" spacing="15">

                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <Label styleClass="input-label" text="Send via:"/>

                                <RadioButton fx:id="rbGsm"
                                             text="GSM Module"
                                             selected="true"
                                             toggleGroup="$smsMode"/>

                                <RadioButton fx:id="rbApi"
                                             text="API"
                                             toggleGroup="$smsMode"/>
                            </HBox>

                            <Region HBox.hgrow="ALWAYS"/>

                            <Label fx:id="charCount"
                                   styleClass="char-count"
                                   text="0/160 characters"/>
                        </HBox>

                        <HBox alignment="CENTER_LEFT"
                              spacing="15"
                              styleClass="action-buttons-container">

                            <Button fx:id="btnSendSMS"
                                    styleClass="primary-button"
                                    text="Send SMS">
                                <padding>
                                    <Insets left="30" right="30"/>
                                </padding>
                            </Button>

                            <Button text="Clear"
                                    styleClass="secondary-button">
                                <padding>
                                    <Insets left="25" right="25"/>
                                </padding>
                            </Button>
                        </HBox>
                    </VBox>
                </VBox>

                <VBox spacing="15" styleClass="message-section">
                    <HBox alignment="CENTER_LEFT" spacing="15">
                        <Label styleClass="section-title" text="SMS History"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Label styleClass="logs-count" text="Recent Messages"/>
                    </HBox>

                    <TableView fx:id="adminTable"
                               styleClass="logs-table"
                               VBox.vgrow="ALWAYS">

                        <columns>
                            <TableColumn fx:id="dateSentColumn" prefWidth="150" text="Date Sent"/>
                            <TableColumn fx:id="fullNameColumn" prefWidth="180" text="Recipient"/>
                            <TableColumn fx:id="phoneColumn" prefWidth="130" text="Phone Number"/>
                            <TableColumn fx:id="msgColumn" prefWidth="300" text="Message"/>
                            <TableColumn fx:id="statusColumn" prefWidth="100" text="Status"/>
                            <TableColumn fx:id="actionsColumn" prefWidth="100" text="Actions"/>
                        </columns>

                        <columnResizePolicy>
                            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
                        </columnResizePolicy>
                    </TableView>
                </VBox>

            </VBox>
        </ScrollPane>
    </VBox>
</AnchorPane>
